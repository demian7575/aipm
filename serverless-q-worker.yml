service: aipm-q-worker

provider:
  name: aws
  runtime: nodejs18.x
  region: us-east-1
  stage: prod
  environment:
    QUEUE_TABLE: aipm-amazon-q-queue
    GITHUB_TOKEN: ${env:GITHUB_TOKEN}
  iam:
    role:
      statements:
        - Effect: Allow
          Action:
            - dynamodb:UpdateItem
            - dynamodb:GetItem
          Resource: arn:aws:dynamodb:us-east-1:*:table/aipm-amazon-q-queue

functions:
  qWorker:
    handler: q-worker-lambda.handler
    timeout: 60
    memorySize: 256
    events:
      - stream:
          type: dynamodb
          arn: arn:aws:dynamodb:us-east-1:728378229251:table/aipm-amazon-q-queue/stream/2025-11-30T03:55:52.749
          batchSize: 1
          startingPosition: LATEST

package:
  patterns:
    - 'q-worker-lambda.js'
    - '!apps/**'
    - '!venv/**'
    - '!node_modules/**'
    - '!.git/**'
