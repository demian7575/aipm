{
  "templateId": "user-story-generation",
  "version": "1.0",
  "description": "Generate user stories from simple ideas",
  
  "input": {
    "schema": {
      "type": "object",
      "required": ["idea"],
      "properties": {
        "idea": {
          "type": "string",
          "description": "User's story idea or requirement"
        },
        "parentId": {
          "type": "string", 
          "description": "Optional parent story ID for child stories"
        },
        "frontendUrl": {
          "type": "string",
          "default": "http://44.220.45.57:3000",
          "description": "Frontend URL for direct posting"
        },
        "context": {
          "type": "object",
          "description": "Additional context information"
        }
      }
    },
    "example": {
      "idea": "I want to add a search feature",
      "parentId": "story-123",
      "frontendUrl": "http://44.220.45.57:3000",
      "context": {
        "project": "AIPM",
        "priority": "high"
      }
    }
  },

  "output": {
    "schema": {
      "type": "object",
      "required": ["success", "action", "storyId", "timestamp"],
      "properties": {
        "success": {
          "type": "boolean",
          "description": "Whether the story was successfully posted to frontend"
        },
        "action": {
          "type": "string",
          "description": "Action performed (posted-to-frontend)"
        },
        "storyId": {
          "type": "string",
          "description": "Generated unique story ID"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "When the action was completed"
        },
        "frontendResponse": {
          "type": "object",
          "description": "Optional response from frontend API"
        }
      }
    },
    "example": {
      "success": true,
      "action": "posted-to-frontend",
      "storyId": "story-1735632132469",
      "timestamp": "2025-12-31T05:16:28.517Z",
      "frontendResponse": {
        "status": "created",
        "id": "story-1735632132469"
      }
    }
  },

  "prompt": {
    "template": "Create a user story for: {{idea}}\n\n{{parentContext}}TASK: Generate story data, post it once, then stop.\n\n1. Generate story fields:\n   - storyId: story-[timestamp]\n   - title: [concise title]\n   - description: As a [role], I want [goal] so that [benefit]\n   - asA, iWant, soThat: [extract from description]\n   - components: [relevant components]\n   - storyPoint: [1-13 based on complexity]\n\n2. Execute this command ONCE:\ncurl -X POST {{frontendUrl}}/api/story-created -H \"Content-Type: application/json\" -d '[JSON with generated data]'\n\n3. Return final result:\n{\"success\":true,\"action\":\"completed\",\"storyId\":\"[generated-id]\",\"title\":\"[generated-title]\",\"message\":\"Story created successfully\"}",
    "variables": {
      "idea": "{{input.idea}}",
      "parentContext": "{{#if input.parentId}}Child of: {{parent.title}}\n\n{{/if}}",
      "frontendUrl": "{{input.frontendUrl || 'http://localhost:3000'}}"
    },
    "instructions": [
      "Complete this task in ONE execution cycle",
      "Generate story data, post it once, then return final result",
      "Do NOT repeat or loop the process",
      "Use realistic values for all fields",
      "Execute curl command exactly once",
      "Return completion confirmation and stop"
    ]
  }
}
