{
  "templateId": "user-story-generation",
  "version": "1.0",
  "description": "Generate user stories from simple ideas",
  
  "input": {
    "schema": {
      "type": "object",
      "required": ["idea"],
      "properties": {
        "idea": {
          "type": "string",
          "description": "User's story idea or requirement"
        },
        "parentId": {
          "type": "string", 
          "description": "Optional parent story ID for child stories"
        },
        "frontendUrl": {
          "type": "string",
          "default": "http://44.220.45.57:3000",
          "description": "Frontend URL for direct posting"
        },
        "context": {
          "type": "object",
          "description": "Additional context information"
        }
      }
    },
    "example": {
      "idea": "I want to add a search feature",
      "parentId": "story-123",
      "frontendUrl": "http://44.220.45.57:3000",
      "context": {
        "project": "AIPM",
        "priority": "high"
      }
    }
  },

  "output": {
    "schema": {
      "type": "object",
      "required": ["success", "action", "storyId", "timestamp"],
      "properties": {
        "success": {
          "type": "boolean",
          "description": "Whether the story was successfully posted to frontend"
        },
        "action": {
          "type": "string",
          "description": "Action performed (posted-to-frontend)"
        },
        "storyId": {
          "type": "string",
          "description": "Generated unique story ID"
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "When the action was completed"
        },
        "frontendResponse": {
          "type": "object",
          "description": "Optional response from frontend API"
        }
      }
    },
    "example": {
      "success": true,
      "action": "posted-to-frontend",
      "storyId": "story-1735632132469",
      "timestamp": "2025-12-31T05:16:28.517Z",
      "frontendResponse": {
        "status": "created",
        "id": "story-1735632132469"
      }
    }
  },

  "prompt": {
    "template": "STRICT TASK: Create user story for '{{idea}}' and return JSON data.\n\n{{parentContext}}REQUIRED STEPS:\n1. Generate story with these exact fields:\n   - storyId: story-[current timestamp]\n   - title: [descriptive title for {{idea}}]\n   - description: As a [role], I want [goal] so that [benefit]\n   - asA: [role from description]\n   - iWant: [goal from description]\n   - soThat: [benefit from description]\n   - components: [\"WorkModel\"] (use valid component)\n   - storyPoint: [1-8 number]\n   - enhanced: true\n   - enhancedAt: [current ISO timestamp]\n   - source: \"kiro-direct\"\n\n2. EXECUTE EXACTLY: curl -X POST {{frontendUrl}}/api/story-created -H \"Content-Type: application/json\" -d '[the JSON from step 1]'\n\n3. RETURN ONLY the JSON from step 1 (no other text)",
    "variables": {
      "idea": "{{input.idea}}",
      "parentContext": "{{#if input.parentId}}Parent: {{parent.title}}\n{{/if}}",
      "frontendUrl": "{{input.frontendUrl || 'http://44.220.45.57:3000'}}"
    },
    "instructions": [
      "Follow steps 1-3 exactly in order",
      "Do NOT deviate from the format",
      "Use WorkModel as component (it's valid)",
      "Return ONLY the JSON object, nothing else",
      "Execute curl command with the exact JSON",
      "Do not explain or add commentary"
    ]
  }
}
